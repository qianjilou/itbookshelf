# 第8章 php的函数应用
- [ ] 函数的定义
- [ ] 自定义函数
- [ ] 函数的工作原理和结构化编程
- [ ] php变量的范围
- [ ] 声明及应用各种形式的php函数
- [ ] 递归函数
- [ ] 使用自定义函数库

&emsp;&emsp;函数就是有一定功能的一些语句组织在一起的一种形式，定义函数的目的
则是将程序按功能分块，方便程序的使用、管理、阅读和调试。函数有两种，
管
一种是别人写好的或系统内部提供的函数，你只要知道这个函数是干什么用的，
自己会用就行了，不用管里面究竞是怎么实现的; 另一种函数是自己定义的，
用来实现自己独特的需求。函数的概念比较抽象，会有一些读者觉得难以理解。
例如，我们可以把函数理解成一个“自动取款机”，如果你需要取款，则需要提
供一些“参数”(银行卡、密码、取款全额),之后自动取款机在内部做了一些
事，并会从 出 口有“返回值”(一打钱): 对于这个“取款机”(内部函数),你
可以不知道它内部是怎么工作的，但你要知道它的功能，知道怎么使用。如果你自己水平够高，自
己可以制作一个“吐钱机器”(自定义画数) 本章重点讲解PHP 中画数的定义和使用方法，并通
过大量适用的示例进行分析说明。



---

## 8.1 函数的定义

像数学中的函数一样，在数学中，y(x)是基本的函数表达形式，x 可看做是参数,y 可看傲是返回值: 所以函数定义就是个被命名的、独立的代码段，它执行特定的任务，并可能给调用它的程序返回一个值。该定义中的各部分如下。  

函数是被命名的: 每个两数都有唯一的名称，在科序的其他部分使用该名称，可以执行函数中
的语句，称为调用函数。  

函数是独立的: 无须程序其他部分的千预，函数便能够单独执行其任务。  

函数执行特定的任务: 任务是程序运行时所执行的具体I作，如将一行文本输出到浏览器、对
数组进行排序、计算立方根等。  

函数可以将一个返回值返回给调用它的程序: 程序调用承数1,将执行该丽数中的语句，而这
些语句可以将信息返回给调用它们的程序。  

PHP 的模块化程序结构都是通过函数或对象来实现的，函数则是将复杂的PHP 程序分为若十个功
能模块，每个模块都编写成一个PHP 函数，然后通过在脚本中调用函数，以及在函数中调用函数米实
现一些大型问题的PHP脚本编写。使用函数的优越性如下所示:

无 兄 弟，不 编程

- [ ] 提高程序的重用性。
- [ ] 提高软件的可维护性。
- [ ] 提高软件的开发效率。
- [ ] 提高软件的可靠性。
- [ ] 控制程序设计的复杂性。

函数是程序开发中非常重要的内容。因此，对函数的定义、调用和值的返回等，要尤其往重理解和
应用，并通过上机调试加以巩固。


---

## 8.2 自定义函数

编写函数时首先要明白你希望函数做什么，知迸这一点后，编写起米便不会太困难。在PHP中除
了已经是供给我们使用的数以千计的系统函数之外，还可以根据模块需要自定义函数。所谓的系统函数
是在PHP 中提供的可以直接使用的函數，每一个系统函数都是一个完整的可以完成指定任务的代码段。
多学会一个系统兩数，就多会一个PHP 的功能。在开发时，一些常用的功能都可以借助调用系统所数
来完成。如果某些功能模块在PHP 中没有提供系统函数，就需要自己定义函数。完成同样的任务，使
用系统函数的执行效率会比自定义函数高，但两种函数在程序中的调用方式是没有区别的。

### 8.2.1 函数的声明  

在PHP中卢明一个自定义的函数可以使用下面的语法格式:
```
/函 数 头
funetion 函数名(|参数1,参数2，..多数n])
/函数体开始的花括号
/任何有效的PHP 代码都可以作为西数体使用
函数体;
/可以从函数中返回一个值
返回值;
retur
/雨数结東的花括号
```
函数的语法格式说明如下。
(1)每个函数的第一行都是函数头，由声明函数的关键字funetion.函数名和参数列表三部分组成，
其中每一部分完成特定的功能。
(2) 每个自定义两数都必须使用“fumction" 关键字声明。
(3) 函数名可以代表整个函数，可以将函数命名为任何名称，只要避循变最名的命名规则即可。每
个函数都有唯一的名称，但需要注意的是，在PHP 中不能使用函数重载，所以不能定义重名的兩数，
也包括不能和系统函数同名。给函数指定一个描述其功能的名称是个不错的主意。
(4) 声明函数时函数名后面的括号也是必须有的,在括号中表明了一组可以接受的参数列表，参数
就是声明的变量，然后在调用函数时传递给它值。参数列表可以没有，也可以有个或多个参数，多介
参数使用迫号分隔。
(5) 函数体位于函数头后面，用花括号括起来。实际的工作是在两敬体中完成的。雨敬被调月后.
首先执行函数体中第条语句，执行到relurm 语句或最外面的花括号后结束，返回到调用的程序。函数
体中可以使用任何有效的PHP代码，甚至是其他的函数或类的定义也可以在函数体中声明。

(6) 使用关键字retum 可以从丽数中返回一个值,在return后面加上一个表达式,程序执行到returm
语句时，该表达式将被计算，然后返回到调用程序处继续执行。函数的返回值为该表达式的值。
因为参数列表和返回值在函数定义时都是可选的,其他的部分是必须有的,所以声明函数时通常有
以下几种方式。
i 1) 在声明函数时可以没有参数列表。
finction 函数名0 {
函数体;，识道以所们中能就然说感实代能代教张的国然的然未保的1作样济处热供的
识我也41源北加民他的的的然的海动地，并路门湖之06
returm 返回值;
(2) 在声明函数时可以没有返回值。
t pu? 街的热器例水对激期准
fumction 函数名([参数1,参数...参数n])
函数体;
(3) 在声明函数时可以没有参数列表和返回值。
fumction函数名0083派、5的28际外四中银，湖张吸34心提洲该货领书尖可成入国顾民，典的
雨数体，的的51步头组的必第9、年种号地
在第7 草中介绍过一个使用双层循环输出10行10列表格的示例,如果在一个程序中的不同地方多
次输出同样的表格,显然在每次输出的地方都定义这样的双层循环不太合适。软件会变得很复杂，不仅
代码会非常臃肿，而且可维护性也非常差,开发效率和可靠性都会降低。解决这样的问题就是将这个特
定的任务编写成- 一个模块，也就是将完成输出表格的所有代码使用化括号括起来，并起- 一个名字,然后
使用function 关键字岸明为一个函数。这样，在需要输出此表格的地方只要通过函数名调用一下,就
会执行一次丽数内部的代码，并在调用的位置输11表格。丽数只被声明次，就可以在任何需要的地方
调用执行，提高了代码的可重用性。而且只要函数内部的代码有所改动，所有调用该函数的地方都会随
着改变，提高了代码的可维护性,因此开发效率和可靠性都会提高。将输出表格的示例声明为一个函数，
如下所示:
```
t7php
椅使带双施tor谐环馨出表帮的礼码声骅为函数，函兹名为e eble./
11函数名为tase
ftunctlon tabluC) {
/)藩出表船
"< tabl 。al igr= ' ce nte c " bc d e = " 1 ." wi : :th= " t 00 ‘ > " ;
ocbo
1/潮出 表船 ln 退
ecbo "< ap :ion><h1>通过函散轴出表格</hi><lcaption>";
: 1o; Soul++ ，{
fon (Sout -0; Sul
/1范用外层谱环触&6 表相行
< 10; $ul++
PPPP-
Sbgoolor - South -- 0 0 "PP?PP" “#DDDDD";
"J 氓里厢行英色
echo "tr bgcnlor=".sbgeolor >”;
0
1
fox(Sin-0; $in <10; Sin++) {
11使用以层懂环赣e 去格列
12
echo"<td>".《6out*10+Sin)."</td>*;
ocho' '。 1 't : > " :
I7
cho "e / tat 1e : " ;
。
//ta23e涵数结索花每号
```

在上而的示例中声明一个两数名为table 的函数，将使用双层for 循环输出的表格代码作为西数休
声明在函数中。声明的table 函数没有参数列表也没有返回值,是最简单的自定义函数。

### 8.2.2 函数的调用  

不管是自定义的幽数还是系统函数，如果函数不被调用，就不会执行。只要在需要使用函数的位置，
使用函数名称和参数列表进行调用。函数被调用后开始执行函数体中的代码,执行完毕返回到调用的位
置继续向下执行。所以在函数调用时函数名称可以总结出以下三个作用。
(1)通过函数名称去调用兩数，并让所数体的代码运行，调用儿次函数体就会执行儿次.
(2) 如果函数有参数列衣，还可以通过函数名后面的小括号传入对应的值给参数，在函数体中使
参数来改变函数内部代码的执行行为。
(3) 如果函数有返回值，当函数执行完毕时就会将relurm后面的值返回到调用函数的位置处,这样
就可以把两数名称当做丽数返回的值使用。
只要声明的函数在脚木中可见，就可以通过函数名在脚本的任意位置调用，在PHP 中可以在函数
的声明之后调用，也可以在函数的声明之前调用，还可以在函数中调用函数。在上例中虽然声明了函数
table(),但如果没有被调用，就不会执行。如果我们在函数table()户明的前面和后面分别调用一次，函
数就会被执行两次，在两个调用的位置输出两个表格。如下所示:
```
<?php
痉凶数脑明之精涉过涵鼓容加上小帮号调用1谢台定义的确教
tablut);
ftmotdon table() !
@ 数体部3 1 础 酵
tablet);
```
11 进 品 裁同 孵之 后 遵过因 然 t& 就L 少 结 每 端用上 感 占它义的瓯 数
该程序执行后输出结果如图8-1所示。
工帝中高中中
O此，6 点王晚蜂六ec-tmF3s
↓ dR8 ，
Eemem hwfe.e
通过函数输出表格
通过函数输出表格
图8-1通过函数输出二上维表格

### 8.2.3 函数的参数  

参数列表是由零个、一个或多个参数组成的。每个参数是一个表达式，用逗号分隔。对于有参函数,
在PHP 脚本程序中和被调用函数之间有数据传通关系。定义函数时函数名后而括号内的表达式称为形
式参数(简称“形参”),被调用函数名后面括号中的表达式称为实际参数(简称“实参”)，实参和形参
需要校顺序对应传递数据。如果函数没有参数列表，函数执行的任务就是固定的，用户在消用医数时不
能改变所数内部的一些执行行为。例如，前面介绍的table()函数就是没有参数列表的函数，每次调用
table()函数时都会输出固定的表格，用户连最基本的表名、表的行数和列数都不能改变。
如果函数使用参数列表，函数爹数的具体数据值就会从函数外部获得。也就是用户在调用函数时，
在函数体还没有执行之前，将些数据通过丽数的参数列表传递到函数内部，这样雨数在执行函数体
时，就可以根据用户传递过来的数据决定函数体内部如何执行。所以说，函数的参数列表就是给用户调
用函数时提供的操作接口。我们将上例中的table()函数修改一F,在参数列表中加上三个参数，让用户
调用table()函数时可以改变表格的表么、行数和列数。如下所示:
```
<?pbp
Q 定X 函兹tab2 e们j时。照明三个参效亦效之间使用想号分船
epx sting stablelaze 斋要一个宇符申类型的表名
著辱一个整型效道设复表裕的5 鼓
Szoms
BP4EE2
若莫务个整型道设豆表都的利蒙
@patan int
Scols
”瓯教四明时。脑明三个御数
Eumctiom tablel stableHeme.Srow.Scolw 1.........
achon “<table align='centec" borde="I' wiltl='600">";
”使用第一个步数3tab1sNase/9 力鼬出表名
ectho “< apt ior ><h1> Stahleene <fhl>t/captLon>";
”1贞用第二个曲数r 四都定表行赦
Eor1Sout-o; Gout < Stors; Sout11]{
Sbgcnlor 一$aut.%? -- 0 7 “PPPPP" “带005D";
nchn "<tr hgeelor=" Shgen
e.">";
(6 n-0o
/使男第三个参数SC 01S 指定表列教
-0; Sin < Scal*; Sintt) .....
far
生
etho"std>".(Sout*scols+Sin) .“</td>";
20
ocho" < ， it t > ， :
2
2
eeho "xiteble?";
```
在定义函数table()时，添加了三个形参; 第一个参数需要一个宁符串类型的表名; 第二个参数是表
格的行数，需要- 一个整型数值; 第三个参数是输出表格的列数，也需要一个整数。这三个形参分别在函
数体中以变量的形式使用，在用户调用时才被赋值并在函数体执行期间使用。调用带有参数列表的tableO
函数，如下所示;
```
< 7?ph p
tablo( “第一个3行9列的表".a,4 ); //等一次谭用(abio(0酉鞭对应营参俊入三个实参
tablo( 第二个2行10列的表“?.10 );1/第二次澳用tebie()通裁，财应型业快人三个英步
/ 第三片源界tabie( 西数，对应思参俊入三个实参
tablo( “第三个5行5列的表”，5,5 );
```
该程序执行后输出结果如图8-2 所示。

在函数中使用的参数列表，是用户调用函数时传递数据到函数内部的接口。可以根据市明函数时的
需要设置多个参数。上例中已经设置了三个参数，用来在调用时改变衣格的农名、行数和列数。如果还
想让用户调用table()函數，可以改表格的宽度、背景颜色及表格边框的宽度，只要在声明函数时，在参
数列农中多设置三个参数即可。

### 8.2.4 函数的返回值  

在定义函数时，函敬名后面括号中的参数列表，是用户在调用函数时用来将数据传递到函数内部的
接口。而函数的返回值，则将函数执行后的结果返回给调用者。如果函数没有返回值，就只能算是一个
执行过程，只依靠函数傲一些事情还不够，有时更需变在程序脚本中使用函数执行后的结果。由于变量
的作用域的差异，调用函数的脚本程序不能直接使用函数体里面的信息，但可以通过关键字relurn 向调
用者传递数据。relum 语句在函数体中使用时，有以下两个作用。
- [ ] rtum 语句可以向函数调用者返回函数体中任意确定的值。
- [ ] 将程序控制权返回到调用者的作用域，即退出函数。在函数体中如果执行了return 语句,它后面的语句就不会被执行。
再次修改table)函数,把该函数单纯的输出表格的功能，修改成创建表格的功能。上例中的table()
函数只要被调用，就必须输出月户通过传递参数指定表名、行数和列数的表格。如果将函数体中所有输
出的内容都放到一个字符串里.并使用retum 语句返问这个存有表恪数据的字符串，在调用table()函数
时，就不是必须输出用户指定的表格了，而是获取到用户制定的表格字符中。用户不仅可以将获取的字
符串直接输出显示表格，还可以将获取到的表格存储到数据库或文件中，或者有其他的字符串处理方
式。如下所示:
```
s 7ph p
利定的共名牛片申
Qcetur: strzngy 返回老格代码学带事
tunction table( seablename.Sxons.Scals ){
赢验- 个立辛狩审疾八表裕
Satr table = "";
6utr tablc.-"<table align='center* bosdex='1' widLb="600">";
t.bl。.."eGati on*h1> Sta
ion>";
lame </
Satx
</hl></capt
”1使需第个幽教scon 拨定丧行羡
foz(sout-0,Sout < Srom; Sout++.01.......
sbgooler = Sout2 一- 0 7 “抑?e" "#DDDDD";
Setr_table.= "ett bqcoloz=" Slgeolor
?!使用第三个步数co2=牌定表列蒙
Cuz(Sin-O; 6hi < Scolw: Slo+4) {
Sstirtahle.- "stu >“(Sout*semnlx+Sim] :"</td>";
Satr_table .- “</tr>";
30
Satr tahle .= =<!table>";
5a tr_t e
1返回4 成的表芯字丹申
retun Smtr.tahle;
2
23
1冉返网的结果蟹给受量SCZ
25
Satr - tabln( “第一个1行4列的表”。3。4 );
26
:/ 直控带返回结果输出
acho tahlo(“第二个2行10列的表”。2.10 )
11郑从西数获歌的c: 学疗甲输出
acho $atE;
该程序执行后输出结果如图8-3 所示。
mur theom m 网Dirnern moue.m 想他州阳网
O郡。e ，因国好和麟色公验2↑;4且3
的足围al/lnlwm山
```
第.个2行10列的表
105TMmT1783456
8193苏
第个3行4列的表
OT地wrme
图8 3 利用函数的返回值输出表格
在上例中将table(函数中所有输出的内容都累加到了一个字符串$str_table中，并在函数的最后使
用returm 语句将$str_table返回。这样，调用函数table()时，不仅能将一些数据以参数的形式传到了函数
的内部，还执行了函数，并且在调用函数处还可以使用retum 语句返回的值,而且这个从函数返回的值
可以在脚本中像使用其他值样使用。例如，将其赋给一个变量、直接输出或是参与运算等。
通常在雨数中使用retum 语句可以很容易地返网一个值如果需要返同多个值,则不能通过连续写
多个retum 语句的方式。囚为函数执行到第一个retum 语句就会退出兩数，不会执行其后面的任何代码。
但可以将多个值添加到一个数组中，再使用rtum 返回这个数组,在调用函数时就可以接收到这个数组，
并在程序中像使用其他数组一样。




---

## 8.3 函数的工作原理和结构化编程

仅当函数被调用后，函数中的语句才会被执行，目的是去完成- 一些特定的任务。而函数执行完毕后，
控制权将返回到调用函数的地力，函数就能够以返回值的力式将信息返回给程序。通过在程序中使用函
数，可以进行结构化编程。在结构化编程中，各个任务是由独立的程序代码段完成的。而函数正是实现
“独立的程序代似段”最理想的方式，所以的数和结构化编程的关系常紧密。结构化编程之所以卓越，
有如下两个重要原因。
》结构化程序更容易编写，因为复杂的编程问题被划分为多个更小、更简单的任务。每个任务由
一个函数完成，而函数中的代码和变量独立于程序的其他部分。通过每次处理一个简单的任务，
编程速度将更快。
结构化程序更容易调试。如果称序中有一些无汰正确运行的代码，结构化设计则使得将问题缩
小到特定的代马段(如特定的困数)。
结构化编程的一个相关优点是可以节省时间。如果你在一个程序中编写一个执行特定们务的兩数，
则可以在另一个需要执行相同任务的程序中使用它。即使新程序需要完成的任务稍微不同，但修改一个
已有的雨数比重新编写- 一个新丽数更容易。想想看，你经常使用丽数echo)和var_dump(),虽然你可能
还不知道它们的代码，但在程序中使用它们可以很容易地完成单个任务。编写结构化程序之前，首先应
确定程序的功能,必须做一些规划，在规划中必须列出程序要执行的所有具休任务。然后使用函数编写
每个具体的任务，在主程序中按执行顺序调用每个任务函数，就组成了一个完整的结构化程序。图8-4
是一个包含三个函数的程序，其中每个函数都执行特定的任务，可以在主程序中调用一一次或多次。每当
函数被调用时，控制权便被传递给函数。函数执行完毕后，控制权返回到调用该函数的位置。



---

## 8.4 php变量的范围

变量的范围也就是它的生效范围。大部分的PHP变最只有一个单独的使用范围，也包含了include和require引入的文件。当一个变量执行赋值动作后，会随着声明区域位置的差异，而有不同的使用范
围。大致上来说变量会依据声明的位置分为局部变量和全局变量两种。

### 8.4.1 局部变量  

局邢变量也称为内部变量，是在函数内部声明的变量,其作用域仅限于函数内部，离开该函数后再
使用这种变量是非法的。不仅在函数中声明的变量是局部变量，为声明函设置的参数因为只能在本函数
的内部使用所以也是局部变量。区别在于雨数的参数具体数值从两数外部获得(函数被调用时传入的
值)，而直接在函数中声明的变最只能在函数内部被赋值。但它们的作用域都仅限于函数内部，因为当
每次函数被调用时，函数内部的变量才被声明,执行亢毕后函数内部的变量都被释放。如下所示;
<?php
游试局品空量的演不ib 践
501M LE 日需典
5pazre int sone若要个整型的8或.朗试是舌为两品交盈
fumutlun demu[ Suno ]{
Slwu- 100;
校S6 前内部面码个交暨
r 在园数内部使用两个局品变盈
echu “在函数内部执行: Sune + Stwu=".<SonetStwu)."<bt>";
n
调用ew 酒莉俊t 200赋健给参数5 ne
demn(200 );
i
安國款外部使用两个安盛，早法方向
nchn“在的散外部执行: Sane + Stwm "".(Sone+Stwo);
该程序执行后输出结果如下所示:
在爵最内部执行200+ 100=300
/在函数内部可以访问内部变量，输出的结果
冬布巨.5
/在丽数外部不能访向函数内部的两个变量，所以无法输出结果
在商数外部执行。+-(
在上例中声明- 一个demo()函数，当调用demo()函数时才会声明两个变量$one 和$two,这两个变量
都是局部变量。变量Sone 是在参数中声明的并在调用时被赋值200，另个变量$two 是在函数中卢明
的并直接赋值100,这两个局部变最只能在丽数的内部使用，输出计算结果。当demo 函数执行结束时
这两个变量就会被释放。因此在因数外部访问这两个变量时是不存在的，所以没有输出结果。如果在函
数外部需要调用该变量值，必须通过returm 指令，来将其值传回至主程序区块以做后续处理。如卜所示:
```
C ?php
赠试同部变蠡的承示函数
5pa2m 2st scne 需要一个整型的参数，累试是否岩房郭受量
funetiuo demo( Sone ){
: 网明-个密数dans,所要传人一个整型参数
pone
人
10n
安豆数内竞声明一个交盈
Stm" 100;__
. 。 ape 。限 a
xeturn Sonn+Stwo;
郑戴约运算结兼使用return游句返巴到陋数调用处
11
Snun 一demo<200> :__
调用dcnc 函戴俊(26 o紫道给参数sone,返当值属后受重SU
" 在 函 数 外 都 使用 函 然 中 运 辩 结 果: Sasum 、 lbz >*;11 a :E 或 力 部可台 使 用色 教返回的结 果
echn
```
该程序执行后输出结果如下所示:
在函 数外部 使用 酗数中运算 结 果: : 300
/获得函数内部执行结果，在函数外部使用


### 8.4.2 全局变量  

全局变量也称为外部变量，是在函数的外部定义的，它的作用域为从变量定义处开始，到本那序义
件的未尾。和其他编程语言不同，今局变量不是自动设置为可用的。在PHIP 中，由于函数可以规为单
独的程序片段，所以局部变最会覆盖全局变量的能见度，囚此在函数中并无法直按调用全局变量。如下
所示:
7?ph;
/.在画瓶外歇曲明一个金网充量$ e值为200
Sone ”200;
在西鼓苏事声啊一产金局走量3tu道为100
Stwo 。100;
典十郦试在幽数内就不能应苦使用全同究量rore预5two
fuwullun dumus) (_
echu“运算结果: " .lSome+Stwo)."<br >";1)智些于在通燕内脑新两明并且&赋初道的丽个交鲎
I
1谓用园Ncexro
demn[);
该程序执行后输出结果如下所示:
运算结果: 0
两个变量没有赋初值为NULL,执行两个空值相加后的结果为0
在上例中，函数demo0外面声明了两个全局变量$one和$two,但在PHP中,不能直接在函数中使
用全局变量。所以在demo()丽数中使用的变量$one 和$two,相当于新声明的两个变量，并H没有被赋
初值，是两个空值运算，所以得到的结果为0。函数中若要使用全局变量，必须要利用global 关键字定
义目标变最，以告诉函数主体此变最为全局变最。如下所示;
```
<7php
#涵敷外部萨外一个金局变量sone道为200
$onc- 200:
1在丽数外品同阴一小金局受量scrc道为100
StwO - 100:
用于鼎试在品费内邵使用4ab2关健学加载全局受量ome04 two
fumctlon demo()l
//在函费内思使岸g10b2关题字加载全局受量.加截多个使果逗9 分强
10
gLobal Some,Stwo;
echo“运算结果: “".(Sone+Stwo)."<bc>";1使用到了涵数外郜笋驹的全周受量
1
1
/ ”调果涵影aemo
demo(];
```
该程序执行输出结果如下所示:
H使用global 关键字就叫以加载全局变量在困数中使用尔人2258
运算结果: 300
在函数中使用全局变量除了使用关键字global 外，在全局范围内访问变最的第二个办法，是用特殊
的PHP 自定义$GLOBALS 数组。前面的例子可以写成使用$GLOBALS 替代global.如下所示:
Sonn - 200;
在通数外器声期一个全局毫量sone億为200
Sonn " 200;
1/产通数外部声财一个全局受盐SWO道为100
Stwn = 100;
用干避试在函数内部使HhsLoBaLs 动问业房受量
Tunetion demo() {
S4LOBALSI'tWO'] = S4LOBhLS["ome'] + SGLOBALSI'wo'];
调用瓯东eo
demo().
3
触占结要OO.说明金局变垒教协问到重新姑赋徽
echo $two;
在SGLOBALS数组中,每一个变量为- 一个元素,键名对应变量么,值对应变量的内容。$GLOBALS
之所以在全局范围内存在，是因为$GLOBALS 是个超企局变量。关丁超企局变量，将在后面的章节
详细介绍。


### 8.4.3 静态变量  

&emsp;&emsp;局部变量从存储方式上可分为动态存储类型和静态存储类型。函数中的局部变量，如不专门声明为static存储类别，默认都是动态地分配存储空间的。其中的内部动态变量在函数调用结束后自动释放。如果希望在函数执行后， 其内部变量依然保存在内存中，应使用静态变量。在函数执行完毕后，静态变量并不会消失，在所有对该函数的调用之间共享，即在函数再次执行时，静态变量将接续前次的结果继续运算。并且仅在脚本的执行期间函数第一次被调用时被初始化。要声明函数变量为静态的，用关键字static。

```php
<?php
	function test(){
		static $a = 0;//定义一个静态变量$a,并赋值初值为0
		echo $a;//输出变量$a的值
		$a++;//将变量$a自增1
	}
	test();//第一次运行，输出0
	test();//第一次运行，输出1
	test();//第一次运行，输出2

```
&emsp;&emsp;在上例中，将函数test中的局部变量$a，使用static关键字声明为静态变量，并赋初值为0，函数在第一次执行时，静态变量$a经运算后，从初值0变为1。当函数第一次执行完毕后，静态变量$a并没有被释放，而将结果保存在静态内容中。第二次执行时，$a从内存中获取上一次计算的结果1，继续运算，并将结果2存于静态内存空间中。以后每次函数执行时，静态变量将从自己的内存空间中获取前次的存储结果，并以此为初值进行计算。

---

## 8.5 声明及应用各种形式的php函数

编写PHP程序时，可以自己定义函数，当然如果PHP 系统中有直接可用的函数是最好的了,没有
时才太自己定义。在PHP 系统中有很多标准的函数可供使用，但有些函数需要和特定的PHP扩展模
块一起编译，否在使用它们的时候就会得到- 一个致命的“未定义函数”错误。例如，要使用图像函数
比如imagecreate(ruecolor(),需要在编译PHP 的时候加h GD 的支持。或者，要使用mysql_connect()两
数，就需要在编译PHP 的时候加上MySQL 支持。有很多核心函数已包含在每个版本的PIIP 中,，如字
符串和变量函数。调用phpinfo()或者get_loaded_extensions()叫以得知PHP 加载了哪些扩展阵。同时还
应该往意，很多扩展库默认就是有效的。
调用系统函数和调用自定义函数是一样的方式。系统中为我们提供的每- 一个丽数,都会有详纰的帮
助信息，所以使用函数时没有必要去花费大最的时间去研究函数内部是如何执行的，只要参考帮助文档
完成所数的调用，能实现我们需要的功能即可。当然如果声明一个函数让其他人去应用，也应该提供一
份该函数的详细使用说明。如果想通过帮助文档成功地应用一个的数。则介纠的数使用的帮功文档就必
须包括以下几点。
> 函数的功能描述(央定是否使用这个函数)
使那个函数去完成么祥的任务，都是需要对号入座的，所以通过函数的功能描述就可以让我们
决定在自己的脚本中是否去使用它。
》参数说明(决定怎么使用这个函数)
参数的作用就是在执行函数前导入某些数值，以提供函数处理执行。通过函数的参数传值可以改变
函数内部的执行行为的，所以怎么传值、传什么值、什么类型的值、传几个值等的详细说明才是决定
如何使用函数的关键。
> 返回值(调用后如何处理)
在脚木中通过获取函数调用后的返回值，来决定程序的下一步执行，所以就必须要了解兩数是古有
返回值、返回什么样的值.什么类型的值。
例如下而是自己定义的函数，就包括了这三方面帮助信息,如下所示:
```


```
PHP 函数的参数才是决定如何能成功应用一个困数，或是控制一个函数执行为的标准。又因为PHP
是弱类型语言，参数的设置和应用才会有多种方式，所以学会声明具有不同参数的函数，和可以成功调
用各同形式参数的因数，才是学习PHP 函数的关键。木节就是通过PHP函数的参数这个特点，分别介
绍相应函数的声明印详细应用。



### 8.5.1 常规参数的函数  

常规参数的函数格式说明如卜所示;
/常规参数的函数格式说明%<.
sting exampbl(sringname,intage,doubleheight)
所谓的常规参数的函数，就是实参和形爹应该个数相等、类型- 致。像C 或Java等强类型语言中
的参数使用万法一样。这样函数的调用比较容易，因为灵活性不大，像强类型语言一样要求比较严格(参
数个数是問定的，每个参数的类型也是固定的)。在PHP 中，如果声明这样的雨数就发挥不了PHP弱
类型语言的优势。例如，在上面常规参数的函数语法格式示例中，声明一个名为example的函数,函数
执行后返回一个字符串类型的值。该函数有三个参数,调用时传递的参数个数和顺序必须一致。片且第
个参数必须是字符串类型，第-.个参数必须是整型，第三个参数必须是双精度类型。例如，上例中定
义的求两个整数平方和的函数test()就是“个常规参数的函数，要求必须有两个粮型的参数。系统函数
也有很多属于这种类型的函数，一些使用常规参数的系统函数如下所示:
1必须使用个整数作为参数
slringchr( intasci )
1必须使用个潭点数作为参数
float ceil (float value )
1必须使月两个数组作为参数
amay array_combine (array keys,array values )
iot strnatcmp (sting stl . sring st2)m1:+7符安必 须使 月 两 ↑ 学 符 4中 作 为 参數
/第一个参 数必 须是字符 串 ，第二 个参 数必 须 是 数组级1
stringimplode (stringglue,arraypieces )
stringreaddir( resourcedir,handle)...1必须使用一个资源类型作为参数..



### 8.5.2 伪类型参数的函数  

伪类型参数的函数格式说明如下所示:
#在参数列表中出现类型使用mixed 描述的参数
mixedfumNamne(mixedSargs)
动地为
4在参数列表中出现类型使用number 描述的参数
number funName( muomber Sargs )
PHP 是弱类型的语言，不仅在市明变量时不需妥指定类型，当然在声明函数时参数也不需要指定
类型，所以在PHP中函数的每个参数，都可以为其传递任意类型的值。因为弱类型是PHP浯言的最大
特点，所以在声明一个函数时，可以让同- 一个参数接受任意类型的值。而在C 或Java 等强类型编程语
言中，如果要声明对数组进行排序的方法，就必须为每一种类型的数组写一个排序的方法，这就是所谓
的函数重状，而PHP 这种羽类型多数则不存在重教的概念。在PHP中，如果对各种类型的数组进行排
序，只要声明- 一个函数就够了，所以伪类型参数的函数是PHP 中最常见的函数应用形式。前面我们介
绍过PHP 的伪类型，包括mixed.number 和callback三种，所以这里就不做过多的阐述。在声明函数
时，如果参数能接受多种不同但并不必须是所有的类型的值.在函数的说明文档中就可以使用mixed
标记这个参数类型。如果说明一个参数可以是integer或float,就可以使用number标记参数。除了参数
可以传递伪类型的参数，函数的返回值也可以根据参数类型的不同返回不同类型的值。在PHP 系统中，
像函数emplty().pow()等好多都是这样的函数。


### 8.5.3 引用参数的函数  

引用参数的丽数格式说明如下所示:

#在参数列表中出现使用& 描述的参数说识农豫2论“
void funName (amay&arg )
PHP 中默认是按值传递参数，m H的数的参数也属于局部交量,所以即使在函数内部改变参数的
值，它并不会改变丽数外部的值。函数为子程序，调用函数的程序可以称为父程序。父程序直接传递指
定的值或是变最给函数使用。由于所传递的值或变量，与函数里的数值分别存储于不同的内存区块，所
以如果函数对所导入的数值做了任何变动，并不会对父程序造成直接影响。如下所示:
声剪一个函效test,用于测沭参效
君要一个出 型道 崇鼓
TpaEd ins sa5g
function temt( Sarg) l
1好阅数必改交独数5a的谊为200
Sarg ”200:
。
在文程序中声期一个主与安量war.称督3 1e2
LOO
10
S iw ar
调用e这数，并将变量:
a 神 5 B 数的多 数s aeo
e的您
oat 《Svar} ;
调历
井丹要业
，的出1o0.srur的但设有空化
12
echo Suar;
在上面的程序中，调用test)函数时，将全局变量$var 的“值”传给函数test0。虽然在test)函数中
对变量$arg 指定了新值200,但是并不能改变函数外变量Svar 的值。调用tesu0函数结束后，变量$var
的输出值仍为100。如果希望允许函数修改它的参数值.必须通过引用传递参数。相对于按值传递模式，
并不会将父程序中的指定数值或目标变量传递给函数,而是把该数值或变最的内存储存区块相对地址导
入函数之中。因此当该数值在因数中有任何变动时，会连带对父程序选成影响。如果想要函数的- 一个参
数总是通过引用传递，在函数定义中，在参数的前面预先加上符号“&”即可。如下所示:
声明一个函数a8t，用于洞试彩漿
恶要一个整型億逊数，使用s, 防按引:劳 方式传述参较，宝载必领是受量
epassn nt sarg
funetion toet( 6Saxg 11
11安西教中改变步效a的傍为200.szq2 引明参煎，外部变量S7世故滕改
Sarg= 200;
iD
定父理序中直劈一个全与竞量svar,初遵为1C0
$var .100;
11。
1.螺用teat感兹，并羚竞量tvaz的引用停给函数勃獻政5as
tertlSvax)
euthu' Svar:'
11能出200.Svor 的值在爾数中够改变量3arg时世些为
5var;
在上面的程序中，调用test()函数时，并不是将全局变量Svar的值100传递给函数test()。可以看到，
在test)函数的定义中，使用了引用符号“&”指定变量Sarg为按引用传递方式。在函数体中对变量Sarg
指定了新值200,由于按弓用方式会修改外部数据，所以外部变星$var 的值也一起被修改为200。调用
函数结束后，可以看到变量$var的输出值为200。
注意: 如果在函数的形参中有使用“&”修饰的参數，在调用该函数时就必须传入一个变量给这个
参数，而不能传递一个值。
在PHP 的系统函数中有很多这样的函数，都需要传递- 一个变晨给引用参数，在函数中改变参数变
量的值，则传递的这个参数变量本身的值也会在父程序中被改变。例如，在数组处理函数中的ncxt().
sort(]、shuffle、key(等函数都是引用爹数的函数。其中son()的使用及说明如下所示:
174

水墨丹心 1/2 星期二 16:44:39
第8章PHP的函数应用
//声明个数组，元素成见的烦序是打配的
Sarr = array( 1,5.8.4.6 

.2.9 ];
著出帮严成数想的家序
print x( Sane );
使用sort()函煎旅序，业湖统(一个欺组处益
mort( $ur );
/1粮组sar 排庐5的结果增汕
erint_rt SIE );
可以看到使用sor()幽数成功对数组Sa进行了排序，只需要直接将数组变量$arr作为参数调用sort()
函数处理，原数组就是排序后的顺序。因为sort(使用的是- 一个引用参数，所以在sort 内部对传入的数
组爹数进行排序，父程序向该函数传入的数组变量值也就被改变了。



### 8.5.4 默认参数的函数  

默认参数的函数格式说明如下所示;
在参数列表中出现使用[] 描述的参数
mixcdfumName(stringname [ stringvalue[.int expire]] )
在定义函数时声明了参数，血在调用函数时没有指定参数或是少指定了参数，就会出现缺少参数的
警告。在PHP 中，支持函数的默认方式调用，即为参数指定一个默认值。在调用函数时如果没有指定
参数的值，在函数中会使参数的默认值。默认值必须是常量表达式，不是(例如) 变量、类成员或者
函数调用,PHP还允许使用数组和特殊类型NULL作为默认参数。如下所示:
<7gh p
B定义- 一个幽教名黎为pocson.為i 打印一个人的原世
@woean stcingy somn人的8天属性半将审就认值为然三“
9peranaxnt sageA的辛部网性然(信为20
A 的性别压世，群i认道为“男“
Sparas stcinyg ssex
function petsan( Snme-"张三”.6ngn-20.Snm-"另" )1
.。
echo“我的名字是: {5memel,我的年龄为: {segel.性别:{Ssex) tbr>";
,i
过
，调用函教时三个参数都没育构億，全部使用就认多数
pecaon()
1第一个勘参教转神入的道展益，后两个参数使用利以秒教
petson("李四“;
pecson (" 王 五”。22) :....
，的两个斯训参数教传入的值展益，最听一个参载使用裁训参数
pozwont~贾入“。18,“女“ :;
，在调用动数8，三小场l 业费罚验传入的监国益
该程序执行后输出结果如下所示:
我的名字是: 张三，我的年龄为: 20,性别男民得聪补前以的顾设统治须2aom项雅器
我的名字是，李四，我的年龄为: 20,性别男
我的名字是: 王五，我的年龄为: 22,性别: 男
我的名字是; 赵六，我的年龄为: 18,性别: 女气优然歌
在上例中声明了一个名为person0并带有三个参数的函数，其中的三个参数都被默认赋上初值，即
默认参数。在调用该函数时，如果少传或不传参数,参数将使用默认的值。如果用户在调用函数时传值，
则用传入的值.
当调用两数传递参数时，实参和形参是按顺序对应传递数据的，如果实参个数少于形参,则最石边
的形参不会被传值。当使用默认参数时，任何默认参数必须放在任何非默认参数的右侧，否则，可能函
数将不会按照预期的情况工作。例如,下面的函数声明就是函数默认参数不正确的用法。后面两个参数
175

水墨丹心 1/2 星期二 16:44:49
党共这3 无兄弟，不编程
没有被传值，也没有默认值，在调用时出现警告。如下所示:
1<Ppbp
附定义- 一个幽数容弥为pecsca,用干打印一个人的强性
人助名F属性半将响，材训德为“然三“
eraran estring 5me
人的年彩国性
aparaen 1nt 5age
人的型别属性
sse
apardm etring
“张三 ".Saqe,Smexc} (
fumction perwon( Sname-
echo“我的名字是: {Snsmel,我的年龄为: I9ege),性别: {5oex} <br>";
.第一个就训步颢长经入的僚员盏。后两小和数没有传谐。会出既务晋告报告
per wou 6" 李 四 ";
只需将函数头部的参数列表中，默认参数列在所有没有默认值参数的后面，该程序即可正确执行。
如下所示:
<?php
自定义一个函款名称为pors om 用子8 个人的属堡
人的容下周益产初由
PaEO st5ing Some
人i的年載国性
5age
epacwn iat
《的性别调性，颗认道为男
s 。 。 X
eparam string
Lunetion perwont Sname-.Sage,S=e"男“)
我的空恩T
echn “我的名字是: lsneme],我的年出为:
lsegel,性别: (Ssex1<ke>":
豹两个参数伶道，是有为最后一个参数传億则使用默认道男
porson("李四”。20 :
在上面的代码中，因数person()在调用时，前两个参数是必须传值的参数，如果不传值则会出现错
误。而最后一个参数是可选的参数，如果不传值则使用默认值。在PHP 的系统函数中有很多这样的函
数，前面是必须传值的参数，后面是可选参数。例如print()、explode().mysql_query()、selCookie()等
函数都有必选和可选参数。


### 8.5.5 可变个数参数的函数  

可变参数的函数格式说明如下所示:
mixedfunName(stingarg1[,string..)82并在参数列表中出现使用“...描述的参数游效跑洛院经路
使用默认参数适合实参个数少于形参的情况，而可变参数列表则适合实参个数多于形参的情况。如
果在函数中使用不到多传入的参数则没有意义。通常，用户定义丽数时，设置的参数数量是有限的。如
果希望函数可以接受任意数量的参数，需要在函数中使用PHP系统提供的func_get_args0函敬，它将所
有传递给脚本函数的参数当做一个数组返回。如下所示:
I<7pbp
t
卢劈一个西戴m工电_aes0,帛尹打印秒数列表的值
要然设商声明参戴到神，
但可以俄A 任象个载，任意类型的参教馆
fumot ton more_orge() [
178

水墨丹心 1/2 星期二 16:45:01
第日章PHP的函数应用一
牌5 有诊送线御本硕数的美数当您一个彰组返同
Sargm " funn_geE_arg*();_
11使用or循环通历裁组sares
Si<count(5@9a); 5i++)
fot(S1-0
acho 第".S1."个参数是".Sarge[$i1."<bt>")11分别输出神人函载的母个参颗
/ /调用西数井趣A多个盛数
maro arga("one","two","theee".1.2.3):
余此之 外，也可以使 用func_num_args()函数返区参数的总 数，使用func_get_arg0函数按受- 一个数
学参数，返回指定的参数。上面的函数可以改写为:
< ?php
个的裁more_0501) ，用打印寥殁列表的慊
最然母弃画明少裁列表，但可的传A 伍意个说任意英型的龄兹值
f umot I mos o_az ge 。
1) 使用cor谱环遍历戴饭$ac ss
Eor tSi-0; Si<funo_num_axgot); Si++) (
1沙别物以慌入函鼓的命个步旅
euthu “第”$i “个参数是”fune_yet_ars(Si "<lc>";
1
1谢用路影片麟入多个多数
more nrg=("one",“mo",“three".1.2。3;
上面的两个例子实现了相同的功能，都可以在函数中获取任意个数的参数列表，在函数中使用。
在PHP的系统函数中，也有很多这样的可变参数的函数,例如arayO、echo()和array_merge0)等函数
都可以传递任意多个参数。



### 8.5.6 回调函数  

回调函数格式说明如下所示;
mi xed fo nName (callback ang)w.:a # 在 端 列 表 中 使 用 伪 类 型 callback 描 述
所谓的回调函数，就是指调用函数时并不是传递一个标准的变量作为参数，而是将另一个函数作为
参数传递到调用的函数中。如果在函数的格式说明中，出现“callback”类型的参数，该函数就是回调
函数。callback 也属丁PHP中伪类型的种，说明函数的参数需要接受另- 一个函数作为实参，一个很重
要的问题是为什么要使用两数作为参数呢? 前面介绍过，通过参数的传递可以改变调用函数的执行行
为，但有时仅将一个值传递给函数能力还是有限的，如果可以将一个用户定义的“执行过程”传递到函
数中使用，就大大增加了用户对函数功能的扩展。而如何声明和使用回调函数也是比较关键的问题，如
果需要声明回调函数,就需要先了解一下变量函数。
1.变量函数
变量函数也称为可变函数。如果- 一个变量名后有圆括号.PHP 将寻找与变量的值同名的函数，并
且将尝试执行它。例如，声明一个函数test().将两数名称字符串“test”赋给变量$demo。如果直接打
印Sdemo变量，输出的值一定是字符串“test”,但如果在$demo变最后加上圆括号“Sdemo()”，则为调
用对应$demo 变量值“test”的函数。这样就可以将不同的函数名称赋给同一个变量，再通过变量去调
用这个函数，很类似J 面向对象中多态特性的应用。如下所示:
177

水墨丹心 1/2 星期二 16:45:12
完共23 无兄弟，不编程
<7pt P
庙照第一个两fone,计算两个数的和
计算和战第一个证算元
Ppdcd int 5a
9paramint s5b 计其和的第二个运第无
齿同站典6 的结果
9ze t 2r . : $
functian one( Sa,Sb )1
xatu
Sa+sb;
" t wen
+■明解二个西数:wo,计期两个散的早 抑
2
5前=
9varan iat 动计算平方和的第一个活发元
19
apem in 就计其平方和的第二个凌算元
11
心 回计期 好的结 要
1
Qet=n int
11
:
funnt sinm trom[Sn,Sb]
ret.unrn *向+ Sh*Sh;
1
/..声朗第三个通数tne: e.计算两个数的立方和
“
aa28 ins sa 计真立方和的第一个运最元
0582 202 6 3立为的第一个医费不
个2 源 元
paa 18E ste 计期立方和的票二
2
OC:uEn in: 返回计算后的结果
2;
functloo three(sa,$b] [__
xeturn Sa4satSa + $b+Sb*5b;
27
29
粮函戒容“zse"赋俗变量$resu2 t.我行$cosu2s r)时测噶崩幽戴oner )
Stewult = “une";
30
特函茄名'twc"就治变量tesu2t,我行5res2t: :时刚惆用站裁twod>
'/szesl 一“Pu*:
/.精函数名"tnrse"關给受量sreeuit.我行$resu2c11的则谓用虽数theso()
//5asu2t =rthzee";
。
3
“运算结果是:“Szewult<2,3]; :1交童3cesat接收剧哪个@数容的道就源片哪 个凶散
在上例中声明onc()、two0和thec0三个函数,分別用于计算两个数的和、平方和及立方和。并将
三个函数的函数名(不带圆括号) 以字符串的方式赋给变量Sresult,然后使用变量名$rcsult后面加上圆
括号并传入两个整型参数，就会寻找与变量$result 的值同名的函数执行。大多数函数都可以将函数名赋
值给变晕，形成变量函数。但变量函数不能用于语言结构，例如echo(),print),unset0),sselD,emptyO,
include(,require()及类似的语句。
2.使用变量函数声明和应用回调函数
如果要自定义一个可以回调的函数，可以选择使用变量函数帮助实现。在定义回调函数时，函数的
声明结构是没有变化的只要声明的参数是一个普通变量即可。但在函数的内部应用这个参数变量时，
如果加上圆括号就可以调用到和这个参数值同名的两数了,所以为其传递的参数- 一定要是另一个函数名
称字符串才行。使用回调丽数的目的是可以将一段自己定义的功能传到函数内部使用。如下所示:
5 7pt P
照明回潤西数t2te,些:OO的些数中遭过台定义泶件过故不要的数字
需要秒啸一个顾我方都字学申场力幽颗
```
@param 082p4ck
szwn
Eunctlon fl1tent Sfun ) {
foxc($社=0; $i<= 100; S1++)
EOX
邦联教变量江1
E- 个园想号sfun 1).则为调用和受置szmm 傅同名的西数
1P 5 发 鱼 stunh
LE Sfun(SE) :
cu it inue;

a
echo$i.'tbt>":
12
:3
L5
.助明一个否表an,如黑多最是3的信数就返网teue.否两恋同ase
16
需要一个整数作为参数
paramxne sn12e
1
2n
fumnction ano(Snum) >
L9
returm 5oum3 一- 0;
20
/** 障期一个顾数:we,如果步数是一个创文费龄考后还第于自己的数)返包htso,否则迈@tsiee
apazar int s02 所要个整载传为脚数
二
Eunotion
E5
.....
26
xetuen Snum 一- utrrev(Snwn} ;
27
28
flltez("one");1) t5中4100 内#3的曾数，助然cse是函戴omer }的合称字符串是一个回滞
29
20
- - - - - . .- hr> ， ;
ec ho 。 . -- ------
32
1.打印出1002 内菲回文戴乡数"two"是函数twod 的古称牛持申，是一个回惆
filter (' two');
```
在上面的示例中，如果声明的函数fiter(只是接受普通的值作为参数，则用户能过滤掉的数字就会
比较单一。而本例在定义的函数flter()中，调用到了通过参数传递进来的一个函数作为过滤条件，这样
函数的功能就强大多了，可以在filterO两数中过滤掉你不喜欢的任意数字。在函数filer(内部通过参数
变量Sfun 加上一个圆括号“Sfun()",就可以调用和变最$fun 值相同的函数作为过滤的条件。例如，
例中声明了one()和two(两个函数，分别用于过滤掉100 之内3 的倍数和回文数时，只要在调用filtcr()
“one”和“two”字符串传递给参数，即将这两个函数传递给filter()函数内部使用。
时，将函数名称
3.借助call_user_func_array()函数自定义回调函数
虽然可以使用变量丽数去声明自己的回调函数，但最多的还是通过call_user_func_arrayO甬数去实
现。函数call_user_func_rray0是PHIP中的内置函数，其实它也是一个回调函数，格式说明如下:
mixed call_user_func_arry (callback funtion,aray param_ar )
该两数有两个参数，第一个参数因为使用伪类型alback,所以这个参数需要是- 一个字符串，表示
要调用的函数名，第二个爹数则是一个数组类型参数; 表示参数列表，按照顺序依次会传递给要调用的
函数。该函数的应用示例如下F:
?pt p
严验、个瓯数tu; 01,劲能只输出两个字行甲，目的是作力a21_we..tuo c_oaav6@卿参数
车 .T 长 一打
的
Pa翻ahins 5oSZt 希要传诺个字行中作为参效.
@pscs stinc Susz2 两要保递另一个半种审作为即发
CuneLi om Eun{Smq1.Smwq2)
echo "Sos :1。
s q 1.
anrhn "<h >";
'Shsg2 = " Smog2;
acho
谭沙系坑承数ce11user,taume array(; 调用函裁funn)
is
第一 P 是 袁 为 函 表 Pun ( 的名 称 字行 审
第二个多数则是一个表组。每个元费值发顾牛传遇绐躅用的+1函数多数列表中
179

水墨丹心 1/2 星期二 16:45:31
位无兄弟，不编程
L
ca11user _fune.array('fun".array('TAVPI。。兄弟连"1);
在上例的第16 行通过系统函数call_user_func_array)调用了日己定义的函数fun0.将函数fun()的
名称字符申传递给了cal_user_func_rray()函數中的第一个参数，第二个参数则需要个数组，数组中
元素个数必须和fun()函数的参数列表个数相同.因为这个数组参数中的每个元素值，都会通过
call_user_func_array()函数，按顺序依次传递给回调到的函数fun()参数列表中。所以我们可以将前面通
过变量函数实现的自定义回调函数，改成借助call_user_func_array0函数的方式实现。代码如下所示:
声第回谭函数se,在0- 1OC 的整裁中通过自定义兼岸过器不要的数字
stun 需要传递一一个函费名称子
作 为 密 兹
梦甲1
```
PET callback
funotlon fllter( $Eun ]
for(S1=0; 51<= 100; 51++) l
"使用系统函数:e11nuseE_ftuns_acrayd),湄用空量$zu 随很同的函戒
If( eall_uwer_fure_acay(9fu axay9113 )
。 nti n ue F
I
i
echo SH "<b >";
```
本例的第8 行，在自定义的函数filter()内部，将原来变量甬数位置改写为call_user_fune_array0函
数的调用方式，而函数filter()的应用方式没有变化。
4.类静态函数和对象的方法回调
前面介绍的都是通过全局函数(没有在任何对象或类之中定义的函数) 声明和应用的回调函数; 但
如果遇到回调类中的静态方法，或是对象中的普通方法，则有一些不一样的地方。面向对象技术将在本
书后面的章节中介绍，所以对于本节介绍的这种应用方式，可以在后面的学习和应用中需要时，再回米
翻开本页查阅。回调的方法，如果是一个类的静态方法或对象中的一个成员方法，怎么办呢? 我们再来
看一下call_user_func_array(函数的应用。可以将第一个参数“函数名称字符串”改为“数组类型的参
数”如下所示:
i<?php
啊一个类Deo.类中面明一个静态的成见方法zu1*/
316D. 
clasw Demo (
mtatlo funotion fun(Smsgl,$meg2) {
ecbo *9m=q1=。.Smsgl;
eubo ， ， fbr > "
eobu'snsg2 = "-5uwg2;
1
1
1.声明一个类rest.类中声辨一个誉通的成房法t: n1)*/
i
class Test (
13
funetion fun(pmug1 ，5mag2)，
cebo1smsa1- ，.Sonu1:
1
echo
ecba'Smag2 *.6mag2;
11
180

水墨丹心 1/2 星期二 16:45:42
第a章PHP的函数应用
9
通过系统的断cal_uaci_tunc_aheay 调Rvono类中的静态成员方法tu 1.._._
20
回调类中的成男方法: 剪一个多数业须便用数组，并且这个数组带要 指定两个元素
21
22
第一- 元澳为实名就学障甲，第二个h 素则是源樊中的静态方 法名绿字得审.
23
男二个数也是一个数组运个数组中每个元素道合发顾罗代道给调用Ceno美中的t n1) 方法参敬列良中.
*,
25
call usor _funo axxay( array("Demo",'fun'),axray6"L.MP'," 兄弟连”);
25
27
。遵过系统函数ea11_ uaos_tinc_arearI 调用test英的实明肘家中的成员方法Eun(),
2
回调类中的成员方法:第个步散必3使用象组，并且这个熬组而要背定两个元表
。
第一个元表为对象引用，a 本例也可以是sobj=new Tes: (>97 的s< b3.第一个元囊则层该对兼中的城勇4 些名称中符申。
洲一个步数也是一个数组，过个最组中每个元素监会发顺序转速哈调用new Tenti 对象中的eunry 方陆参影列我小。
3
.
eall.user _fune artay( array(neu Testt).'tam').array('BroFI IP”，「学习型ee框架"} );
32
所以使用call_user_func_array(函数实现的自定义回调函数,或是PHP 系统中为我们提供的所有回
调函数，都可以像该函数一样,在第- 一个参数中使用数组类型值,而且数组中必须使用两个元素: 如果
调用类中的成员方法,就需要在这个数组参数中指定第个元素为类名称字符串,第二个元素则是该类
中的静态方法名称字符串: 如果是调用对象中的成员方法名称，则这个数组中第一元素值为对象的引用,
第 二 个 元 素 则 是 :该 对 象 中 的 成 员 方 法 名 称字 符 串。calluser_func_array()函 数 的 第 二 个 参 数 使 用 设 有 变
化。回调函数的说明格式总结如下所示，其中callback()代表所有回调函数:
#回调全局菌数”871SS
callback("西数名称字符中“
allbeck(array("类名称字符申，“类中静态方法名称字符审1d 激#回调类中的静态成员方法州驱他真，山
alback(array(对象引用，“对象中方法名称字符串"D也创浙县#回调对象中的成员方法派统器求发期
系统为我们提供的回调丽数和我们自定义的回调函数在调用方法上都是完全相同的。在PHP 中，
提供的带有回调丽数的系统兩数有很多，但人多数的应用都会涉及后面章节的知识点，所以这里就不再
过多阐述，不过会在后面章节中看到它们的具休应用。




---

## 8.6 递归函数
递归函数即自调用函数,在函数休内部直接或问接地自己调用自己，即函数的嵌套调用是函数本身。
通常在此类型的函数体之中会附加一个条件判断叙述，以判断是否需要执行递归调用，并且在特定条件
下终止函数的递归调用动作，把目前流程的主控权交回上一层函数执行。因此，当某个执行递归调用的
函数没有附加条件判断叙述时，可能会造成无限循环的错误情形。
函数递归调用最大的好处在于可以精简程序中的繁杂重复调用程序，并且能以这种特性来执行一一些
较为复杂的运算动作。例如，列表、动态树型菜单及遍历目录等操作。相应的非递归函数虽然效率高,
但却比较难编程，而且相对来说可读性差。现代程序设计的目标+要是可读性好。随着计算机硬件性能
的不断提高，程序在更多的场合优先考虑可读而不是高效，所以，鼓励用递归函数实现程序思想。一个
简单的递归调用如下所示:
syt.o
<7php
曲明一个名养为1est矽函戴用于蜊武谜白
persmint $o 满要一个整数作为参效
181

水墨丹心 1/2 星期二 16:45:52
无兄弟，不编程
/)应明一个名为est的幽戴有一个舜数
fumctlon taet( $n )
echo Sn."anbep; snbep:";
,1d 爾教开始处物出参散的道和两个空格
echo Sn.".
判断鱼教是否大于0一
Atsm>0)_.
:如果要影大FC则谓用自己.并拐驶物配;后再陈传A
tost ($n-1);
Ii
1/刻额参就是江不人刑
ole
12
// 麟 86 H ? 片事
echo “<- -> “;
23
4
11t函数结照处瓣出多数的道和两个卒帮
echu $n.“Enbep; anbep ;";
5
云
1
”/调用tes:o )晚数按慰数10传输房数
tet (10) ;
该程序执行后输出结果如下所示:
```
#投到结果中后￥部分的数字正向顺序输出的原因
109876543210 <->012345678910
```
在上例中声明了一个test(函数，该函数需要一个熬型的参数。在函数外面通过传递整数10作为参
数调用test()函数。在test)函数体中，第一条代码输出参数的值和两个空格。然后判断条件是否成立，
成立则调用自己并将参数减1再次传入。开始调用时，它是外层调内层，内层调更内一层。直到最内层
由于条件不允许必须结束。最内层结束了，输出“<->”作为分界符，执行调用之后的代码输出参数的
值和两个空格，它就会同到稍外一层继续执行，稍外一层再结束时，退到再稍外一层继续执行，层层退
出，直到最外层结束。执行后的结果就是我们上面所看到的。递归两数有点像电影《盗梦空间》的剧情
模式，我猜想编剧以前有可能和我们是同行。




---

## 8.7 使用自定义函数库

的数库并不是定义函数的PHP语法，而是编程时的一种设计模式。的数是结构化程序设计的模块，
足实现代码重用的核心。为了更好地组织代码，使自定义的函数可以在同一个项目的多个文件中使用，
通常将多个自定义的函数组织到同一个文件或多个文件中。这些收集函数定义的文件就是创建的PHP
函数库。如果在PHP 的脚本中想使用这些文件中定义的函数，就需要使用include()、include_once(、
require(或 require_once()中 的一 个 函 数，将 函 数库文 件 裁 入到脚 本程 序中。
require()语句的性能与include0相类似，都是包括并运行指定文件。不之处在于，对include()语
句来说,在执行文件时每次都要进行读取和评佔: 而对于require()语句来说，文件只处理一次(实际上，
文件内容替换了require()语句)。这就意味着如果可能执行多次的代码，则使用require()效率比较高。另
一方面，如果每次执行代码时是读取不同的文件，或者有通过一组文件迭代的循环，就使用include()
语句。
require()语句的使用方法如require("myfile php"),这个语句通常放在PHP 脚本程序的最前面。PHP
程序在执行前，就会先读入require(语句所引入的文件，使它变成PHP脚本文件的一部分。include()诏
句的使用方法和rcquirc()语句一样如include("myfile.php")。而这个语句一般是放在流程控制的处理区段
中。PHP脚本文件在读到include()语句时，才将它包含的文件读进来。这种方式，可以把程序执行时的
流程简单化。如下所示:


上例中在一个脚本文件中使用了require()和include()两种语句，include()语句放在流程控制的处理
区段中使用，当PHP 脚本文件在读到它时，才将它包含的文件读进来。而在文件的开头和结尾处使用
require()语句，在这个脚本执行前，就会先读入它所引入的文件，使它包含的文件成为PHP脚本文件的
. 部 分。
require()和include()语句是语言结构，不是真正的函数，可以像PHP中其他的语言结构- 一样，例如
echo()可以使用ccho("abec")形式,也叫以使 用echo"abc"形式输 出字符 串abc.require0和include(语句
也可以不加圆括号而直按加参数,例如include 语句可以使用include("file.php")包含fle.php 文件，也可
以使用include"file php"形式。
include once()和require_once()语句也是在脚本执行期间包括并运行指定文件。此行为和include()
语句及require()类似，使用方法也一样。唯一区别是如果该文件中的代码已经被包括了，则不会再次包
括。这两个语句应该用于在脚本执行期间，同一个文件有可能被包括超过一次的情况下，确保它只被包
括一次，以避免函数重定义及变量重新赋值等问题。




---

## 8.8 小结
本章必须掌握的知识点
- [ ] 函数在过程化编程中的应用
- [ ] 自定义PHP 函数
- [ ] PHP中变量的作用域范围
- [ ] 声明及成用各种形式的PHP函数(全部)
- [ ] 递归函数
本章需要了解的内容
- [ ] 定义和使用自定义函数库
- [ ] 结构化编程的模式
本章需要拓展的内容
- [ ] 在PHP的函数内部声明和应用函数

---
