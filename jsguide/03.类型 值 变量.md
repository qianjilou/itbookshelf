## [第3章 类型、值和变量](https://github.com/qianjilou/itbookshelf/tree/master/jsguide)  
第3章
.......
类型、
值和变量
{比如数字3.14或文本“he1lo world") 进行操
计算机程序的运行锯要对值(value)
作。在编程语言中，能够表示并操作的值的类型称做数据类型(type)，编程语言最基
本的特性就是能够支持多种数据类型。当程序需要将值保存起来以备将来使用时，便将
其赋值给(将值“保存”到)一个变景(variable)。变悬是一个值的符号名称，可以通
过名称来获得对值的引用。变量的工作机制匙编程语言的另、个基本特性。本章将评细
#解JavaScript中的类型.值和变最。这用的引言只做概述，你叮以通过蜜照1.1节来帮
助理解本章内容。后续章节会更深人地讲解。  

JavaScipt的数据类型分为两类: 原始类型(prinitive type) 和对象类型(object
type)。JavaScript中的原始类型包括数字、字符串和布尔值; 本章会有单独的章节专| I
讲述JavaScript中的数字(见3.1节)和字符串(见3.2节),布尔值将会在3.3节讲解。  

JavaScript中有两个特殊的原始值: nu11(空) .和lundefined (未定义)，它们不是数字,
字符审和布尔值。它们通常分别代表了各肖特殊类型的唯一的成员。3.4节将会详细讲解
null和undefined。  

JavaScript中除了数字、字符串、布尔值、null和undefined之外的就是对象了。对象
(cbject) 是属性(property) 的集合，每个属性都由“名/值对”{值可以是原始值，
比如数字、字符串，也可以是对象} 构成。其中有一个比较特殊的对象-
~全局对象
(glnbal bject)一会在3.5节介绍，第6章会有更完整详细的描述。  

普通的JavaScript对象是“命名值”的无序集合。JavaScript同榉定义了一种特殊对
象-
数组(array) ，表示带编号的值的有序集合。JavaScript为数组定义了专用的语
法，使数纠拥有一些和普通对象不同的特有行为特性。第7章将专门讲述数组。

函数。函数是具有与它相关联的可执行代码的
JavaScript还定义了另~种特殊对象-
政
对象，通过调用闲数来运行叮执行代码，井返叫运算结果。和数组一样，函数的行为特
征和其他对象都不一样。JavaScript为使用函数定义了专用语法。对于JavaScript函数来
讲，最重要的是，它们都是真值，并H.JavaScript可以将它们当做普通对象来对待。第8
章会专门讲述函数。  

如果函数用来初始化(使用new运算符)一个新建的对象，我们称之为构造凼数
由构造函数初始化的
(constructor)。每个构造函数定义了一类(class) 对象
对象组成的集合。类可以看做是对象类型的了类型。除了数组(Array) 类和函数
(Function) 类之外，JavaScript语言核心定义「其他三种有用的类。E 期(Date) 类定
义了代表日期的对象。正则(RegExp) 类定义了表示正则表达式(一种强大的模式匹配
工具，在第10米会诽到) 的对象。错误(Error) 类定义了那些表示JavaScript程序中运
行时错误和语法错误的对象。可以通过定义白己的构造函数来定义需要的类。这会在第
9章讲述。  

JavaScript解释器有自己的内存管理机制，可以自动对内存进行垃圾回收(garbage
collection)。这意味着程序可以按需创建对象，程序员则不必担心这些对象的销毁和内
存回收。当不冉有任何引用指向一个对象,解释器就会知道这个对象没用了，然后自动
回收它所占用的内存资源。  

JavaScript是一种面向对象的语言。不严格地讲，这意味着我们不用全局的定义函数去操
作不同类型的位，数据类型本身可以定义方法(method) 来使用值。例如，要对数组a
中的元索进行排序,不必要将a传人sort()丽数，而足调用a的一个方法sort():
```
a.sort{); !1sort(a)的面向对象的版本
```
第9章将会讲述力法的定义。从技术上讲，只有JavaScript对象才能拥有方法。然而，
数字、字符串和布尔值也可以拥有自己的方法(3.6节解释其工作机制)。在JavaScript
中，只有nu11和undefined是无法拥有方法的值。  

JavaScript的类型可以分为原始类型和对象类型，也叮分为可以拥有乃法的类型和不能
拥有方法的类型，同样可分为可变(mutable) 类型和不可变(immutable) 类犁。可空
类型的值是可修改的。对象和数组属于可变类型: JavaScript程序可以更改对象属性值
比如，修改一个
和数组元素的值。数字、布尔值。nu1l和undefined属于不叮变类型
数值的内容本身貌说不通。宁符串可以看成由字符组成的数组，你叮能会认为它是可
变的。然而在JavaScript中,字符串是不可变的: 可以访问字符串任意位胃的文本，但
JavaScript#未提供修改已知字符串的文本内容的方法。3.7节会详细讲解可变类型和不
可变类型的不同之处。

JavaScript可以自由地进行数据类型转换。比如，如果在程序期望使用字符串的地方使用
了数字; JavaScript会自动将数字转换为宇符串。如果在期望使用布尔值的地方使用了非
布尔值，JavaScript也会进行相应的转换。类型转换规则将在3.8节讲述。JavaScript中灵
活的类型转换规则对“判断相等”{equality) 的定义亦有影响。等号运算符“==”所
进行的类型转换细节将在3.8.1节详细描述。  

JavaScript变量是无类型的(untyped),变量可以被赋予任何类型的值，同样.个变量
也可以重新赋予不同类型的值。使用var关键字来声明(declare} 变貝。JavaScript采
用诃祛怍用域{lexical seoping)。不在任何函数内声明的变量称做全局变量(globa]
variable)，它在JavaScript程序中的任何地方都是可见的。在函数内声明的变量具有函
数作用域(fuuction scope)，并且只在菌数内可见。变量声明和作用域将会在3.9节和
3.10节详细讲解。  

##  3.1 数字  

和其他编程语言饰件1不同; JavaScript不区分整数慎和俘点数值。JavaScript中的所有数
字均用浮点数值表示。JavaScripI采用IEEE 754标强供!定义的64位得点格武表示数宇,
这意味着它能表示的最大值是土1.7976931348623157 x 1o308，最小值是士5 X 10-324。  

安照JavaScript中的数宇格式，能够表示的整数范围是从-9 007 199 254 740 92~
9 007 199 254 740 992 (即-23~z*),包含边界值。如果使用了超过此范围的整散，则
无法保证低位数字的精度。然而需要往意的是，JavaScript中实际的操怍(比如数组索
引，以及第4章讲到的位操作符) 则是基于32位整数。  

当一个数字直接出现在JavaScript程序巾，我们]称之为数字直接量(numeric literal)。
JavaSeript支持多种格式的数宇直接昼; 在接下來的小节中会有讨论。往意，在任何数
字直接量前禄加负号(~) 可以得到它们的负值。但负号是一元求反运算符(参见第4
章)，并不尼数字直接量语法的组成部分。  

###  3.1.1 整型直接量  

在JavaScript程序中，用一个数宇序列表示一个十进制整数。例如:
10000000

---

译注I; 例如C和Java。
}ava程序员应该很热恐这种格式，就拿他们燕悉双精度(doubIe) 类型一样。在C和C++
注1:
的所有现代实现中也都用到了双精度臭型。

---

除了十进制的整型直接录，JavaScript同样能识别十六进制(以16为基数) 值。所谓十六
进制的育接量是指以“OX”或“QX”为前缀，其后跟随十八进制数串的直接量。十六进
制值是0~9之间的数字和a (A)~f (F) 之间的字母构成，日~f的字母对应的表示数宁
10~15。下面是十六进制整型直接量的例子:
```
oxff 1115*16 + 15 = 255 (! 进制)
0XCAFE911
```
尽管ECMAScript标难不支持八进制直接量，但JavaScript的某些实现可以允许采用八进
制(基数为8} 形式表示整数。八进制直接登以数宇Q开始，其后跟随一个出0~7 (包括
0和17) 之问的数字组成的序列，例如:
```
0377 113*B4 + 7*8 + 7= 255 (1进制)
```
山丁某些JavaScript的实现支持八进制直接量，而有些不支持，因此最好不要使用以0为
前綴的整型直.接量，毕竟我们]也无祛得知当前JavaScript的实现是否支持八进制的解析。
在ECMAScript 6 (见5.7.3节) 的严格模式下,八进制直接录是明令禁止的。  

###  3.1.2 浮点型直接量  

浮点型立接量可以含有小教点; 它们采用的是传统的实教与法。.个实数由整数部分、
小数点和小数部分组成。  

此外，还可以使用指数记数祛表示浮点型直接盘，即在实数后跟字母e或E,斤丽再蹤正
负号，其后再加一个整型的指数。这种记数方兆表示的数值，是由前面的实数乘以1)的
指数欢幂。  

可以使用更简待的语迭表示;
```
[digits][.digits][(E|e)[(+l-)]digits]
例如:
3.14
2345.789
3333333333333
6.02e23 116.02 x 1033
1.4738223E-32 111.4738223 X 10 32
```  

###  3.1.3 JavaScript中的算术运算  

JavaScript程序是使用语言本身提供的算术运算符来进行数字运算的。这些运算符乜挢加
法运算符(+)、减祛运算符(-)、乘让运算符(*)、除祛运算符(/) 和求余(梁整
除后的余数) 运算符(%)。第4章将详细介绍这些以及更多的运算符。

除了基本的运算符外，JavaScript还支持更加复杂的算术运算，这些复杂运算通过作为
Math对象的属性定义的函数和常垡来实现:
```
'! => 9D07199254740992: 2 的53次幂
Math.pow(2,53)
/1=> 1.0: 四舍五人
Math.Iound(.6)
/!=> 1.0: 向上求整
Math.ceil(.6)
Math.floor(.6)
/1=> 0.0: 向下求整
/1=> 5: 求绝於值
Math.abs(-5)
/1返网最大值
Math.max(x,y,z)
/1返回最小值
Math.m1n(x,y,z)
/1生成一个人于等于0小于1.Q的伪随机数
Math.xandom()
/l n; 圆周率
Math,PI
Math.E
/I e: 自然对数的底数
/13的平方根
Math.sqrt(3)
Math.pow(3,1/3)
/13的立方根
Math.sin(o)
/! 三角函数: 还有Math.cos,Math.atan竽
Math.log(10)
// I0的自然对数
/1以10为底100的对敬
Ma t h. log 100) /Ma th. LN20
'/ 以2为底512的对数
Math.log(512)/Hath.LN2
/1e的二次筹
Math. exp( 3)
```
参阅第三部分中关于Math对象的介绍，那里列出了JavaScript所支持的所有数学函数。  

下滥(underflow) 或被零整除时不会报
JavaScript中的算术运算在溢出(overflow)
结果为一个特殊
错。当数字运算结界超过了JavaScripl所能表示的数字上限(溢出)
的无穷大(infinity) 值，在JavaScript中以Infinity表示。同样地，当负数的位超过了
JavaScript所能表示的负数范围，结果为负无穷大，在JavaScript中以-Infinity表示。
无穷大值的行为特性和我们所期望的是一致的: 基丁它们的加、减、乘和除运算结果还
是无穷大值(当然还保留它们的正负号)。  

下浴(undef1ow) 足当运算结果尤限接近于零并比JavaScript能表示的最小俏还小的
时候发业的一种情形。这种情况下，JavaScript将会返回0。当一个负数发尘下溢时,
JavaSctipt返回一个特殊的位“负零”。这个位(负零) 几乎和正常的岑完全一样，
JavaScript程序员很少用到负零。  

被零整除在JavaScript并不报错: 它只是简单的返回无穷大(Infinity) 或负无穷大
(-Infinity)。但有一个例外，零除以零是没有意义的，这种整除运算结果也是一个
非数宇(not-&-number) 值，用NaN表示。尤穷大除以尤穷大、给任意负数作开方运算或
者算术运算符与不是数字:或无法转换为数字的操作数一起使用时都将返回NaN。  

JavaScript预定义了全局变量Infinity和NaN,用来表示下无穷人和非数字值。在
BCMAScript 3中，这两个位是可读/写的,并可修改。ECMAScript 5修正了这个错误，
将它们定义为只读的。在ECMAScript 3中Number对象定义的属性值也是只读的。这里有
一些例了:
```
11将一个可读/写的交盘初始化为infnity
Infinity
//同样的值，只读
的月
Number.POSITIVE_INFINITY
11这也是同样的侑
1/0
啡公
1/计算结果还必Infinity
Nurber.MAX_VALUE + 1
/ 该表达式表示了负无穷大
Nurber.NEGATIVE_INFINITY
-Infnity
- 1 /0
-Number.MAX_VALUE- 1
/l 将一个叮读/写的变母初始化为NaN
NaN
11同样的值，但匙只读
Number.NaN
'1计策结果是NaN
/0
/1发尘下滋: 计算结!果为0
Number.MIN_VALUE/2
/1负零
-Numbcr.IN 

 _VALUE/2
/1同样是负容
- 1/ Inf n ity
```
JavaScript中的非数字值有一点特殊: 它和任何值都不相等，包括自身。也就是说，役
办祛通过x==NaN来判断变昼x是否是NaN。相反，应当使用x!=x来判断，当且仅当x为NaN
的时候，表达式的结果才为true.函数isNaN()的作用与此类似,如果拳数是NaN或者
是一个非数字值(比如字符串和对象)，则这回true。JavaScrip中有一个类似的函数
isFinite(),在参数不是NaN.Infnity或-Infnity的时候返回true。  

负零值问样有些特殊，它和正零值是相等的(甚至使用JavaScript的严格相等测试束判
断》。这意味着这两个位几乎一模一样，除了作为除数之外;
```
11正常的零值
var zero .D;
11负孚值
var negz=-C
正零值和负零值相予
11=> true:
zeIo === negz
11=> false: 止无穷大和女无穷大不等
1/2CIO === 1/ncgz
```

###  3.1.4 二进制浮点数和四舍五入错误  

灾数有尤数个，但JavaScript通过得点数的影式只能表示其中有限的个数(确圳地说悬
18 437 736 874 454 810 627个)。也就是说，当在JavaScrip1中使用实数的时候，常常只
足真实值的-个近似表示。  

JavaScript采用了1EEE-754浮点数表示祛(几乎所有现代编程语言所采用)，这是一种一
进制表示法，可以精确地表示分数，比如1/2、1/8和1/1024。造憾的是，我们常用的分
数(特别是在金融计算方面) 都是十进制分数1/10，1/100等。二逃制浮点数表示祛并不
能精确表示类似Q.1这样简单的数字。  

JavaScript4的数字具有足够的精度，非可以极其近似于0.1; 但事实是,数字不能精确
表述的确带来了一些问题。看下这段代码:
```
1130美分减去20美分
varx=.3--2;
1120美分减去10美分
ary= .2-.1;
11m> false:两值小祖等!
x==
!{=> false:.3-.2 不等于.1
!1=> tzue:.2-.-1等丁.1
y == ,1
```
由于舍人误差，0.3和0.2之间的近似差值实际上并不等于0.2和0.1之间的近似差值译社2。
这个问题并不只在JavaScript中才会出现，理解这一点非常重要: 在任何使用二进制俘点
数的编程语言中都会有这个问题。同样需要注意的是，上述代码中x和y的值非常接近彼
此和最终的正确值。这种计算结果可以胜任大多数的计算任务: 这个问题也只有在比较
两个值是否相等的时候才会出现。  

JavaScript的未来版本或许会支持f进制数字类犁以避免这些舍人问题。在这之前你可
能更愿意使用大整数进行重要的金融计算，例如。要使用憋数“分”而不要使用小数
“元”进行基于货币单位的运算。  

###  3.1.5 日期和时间  

JavaScript语言核心包括Date()构造函数,用来创建表示日期和时间的对象。这些日期对
象的方法为日期计算提供了简单的API。日期对象不像数卞那样是基本数拥类型。本节
给出了使用日期对象的一个简单教程。在第三部分可以连阅更多细节:
```
var then= new Date{2011,D,1); 1! 20114 1月1日
var later= new Date(2011,0,1; 17,10,30);11问一天,当地肘间5:10:30pm;
var naw z hew Date(); /1当前日期和吵间
var elapsed= tow- then; 11日期减祛: 计算时间间陨的砻秒数
later.getFullYear{) 11a> 2011
later.getMonth() 11=> 0; 从0开始计數的月份
later.getDate{) 11a> 1: 从1开始计数的大数
later.getDay() 11=> 5: 得到星期几，0代表星期日，5代表晶期
later.getHouIs() 11=> 当地时间17: 5pm
later.getUTCHours{) 11使用UTC表示小时的时间，基十时区
```
##  3.2 文本  

字符串(string) 是一组由16位值组成的不可变的有序序列，每个字符通常来自于
Unicode字符來。JavaSeript通过字符串类型来表示文本。字符申的长度(length) 是其所
含16位值的个数。JavaScript字符串{和其数组) 的索引从零开始; 第一个字符的位置是
0,第二个字符的位置是1，以此类推。空宇符串(empty string) 长度为0,JavaSeript中
并没有表示单个字符的“字符型”。要表示一个16位值，只需将其赋值给宇符串变量即
可，这个字符串长度为1。
译注2: 在JavaScript的真实运行环境中，0.3-0.2=0 099999 999 999 999 98。

<table style="border:1px solid #ccc">
<tr><td>
<h3>字符集，内]码和JavaScript字符串</h3>
JavaScript采用UTF-]6編码的Unicnde字符集，JavaScript字符串是由一俎无符号的16
译i3)
位值组成的序列。最常用的Uricode字符(这些字符属于“基本多语种平面”
都是通过16位的内码表示，并代表字符串中的单个字符，那些不能表示为16位的
Unicode字符则遵据UTF-16编码规则一用两个16位值组成的一个序列(亦称做
“代理项对”) 表示。这意味着一个长度为2的JavaScript宇符串(两个16位值)有可
能衣示一个Unicode字符:  

```
11m 由16位内码表示DX03CO
varp = "n";
/l e出17位内码表示0x1d452
var 白= "e";
/1=> 1: p包含一个16位值
p.length
/1=> 2: e通过UTF-16编码后包含两个16位慎;"\ud835\udc52"
e. length
```
JavaScripl定义的各式字符串操作方法均作用于16位值，而非字苻，，且不会对代理
项对做单独处理，同样JavaScript不会对字符串做标准化的加工，甚至不能保证字
符事是合法的UTF-16格式。
</td></tr>
</table>

###  3.2.1 字符串直接量  

在JavaScript程序中的字符串直接盘，是山单引号或双引号括起来的字符序列。山单引号
定界的字符串中可以包含双引号，山双引号定界的字符串中也可以包含单引号。这里有
几个字符申直接盘的例子:
```
" 11空字符串: 它包含0个宇符
'testing'
'3.14"
form"
' na me="myf
"Wouldn't you prefer O'Reilly's book?"
"This string\nhas two 1ines"
"n is the ratio of a circle's circumference to its diameter"
```
在ECMAScript 3中，字符串直接量必须写在一行中，而在ECMAScript 5中，宇符串直接
景可以拆分成数行，每行必须以反斜线(\) 结束，反斜线和行结束符都不算是字符串直
接量的内容。如果希望在字符申直接量中另起一行，可以使用转义“卞符\n (后续会有介
绍)
```
"two\nlines" 11这里定义了~ 个显示为两行的字符中
用三行代码定义了显示为单行的宇符申.只在ECMAScript 5中可用
'one\ fI 1
long\
```

---

译注1;“基本多语种平齿”(Basic Multilingual Plane,}BMF); 也称“霹断曲”{P1an 0),是Unicode
中的一个编码区段。编码介于U+000~0U+FFFF之间。

---


li ne"
裕要往意的是，当使用单引号来定界宇符串时，需要格外小心英文巾的缩写和所有格写
法，比如can't和O'Rilly's。因为撇号和单引号是同一个字符，所以必须使用反斜线()来
转义(转义符将在下一章讲解) 所有的撇号。  

在客户端JavaScript程序设计中，JavaScript代码会火杂HTML代码的字符串，HTML代
码也会央杂JavaScript代码。和JavaScript一样，HTML也使用单引号或者双引号来定界
字符串，因此，当JavaScript代码和HTML代码混杂在一起的时候，最好在JavaScript和
HTML代码中各自使用独立的引号风格。例如，在JavaScript表达式中使用单引号表示字
符用“Thank you”，而i在HTML事件处理程序属性中则使用双引号表示字符串:
```
<button onclickn"alert('Thank you' )">Click He</button>
```

###  3.2.2 转义字符  

在JavaScripl字符串中，反斜线()有着特殊的用途，反斜线符号后加一个字符,就不再表
评江4,它表示的朵一
示它们的字面含义了，比如，\n就足.个转义字符(escape sequence)
个换行符。  

另一个例子是上书巾提到的转义字符\，表示单引号(或撇母)。当需要在一个单引号
定界的字符用内使用撇号的时候，它就显得非常有用。现在你就会明白我们为什么把它
们叫做转义宇符了，因为反斜线可以使我们避免使用常规方式解释单引号，当单引号不
是用来标记字符串结尾时，它只是一个撇号:
```
'You\'re xight,it can\'t be a quote'
```
表格3-1列山了JavaScript中的转义字符以及它们所代表的含义。其中有两个是通用的，
通让十六进制数表示Latin-1或Unicode中的任意字码。例如，\xA9表示版权符号，版权
符号的Latin-I编码是十六进制数A9。同样，u表示由4个十六进制数指定的任意Unicode
字符，比如，\u03c0表示字符t。  

表3-1:JavaScript转义字符
热兴床付制江合义心:a 的8的的心80年72
NUL字符(\u0000)
0
b
退格符(\u0008)
水乎制表符(\u0009)
t
译注4: escapesequence泽为“转义序列”，有时也译成“转义字符" 和“逃逸得”，本节中统一
译为“转义字符”。

表3-1:JavaScript转义字符(续)
转义字符
含义
换行符(\u000A)
n
垂立制表符(\u000B)
y
换页符(\u000C)
.f
回车符(\u0000)
\r
双引号(\u0022)
撇号或单引号(\u0027)
反斜线(\u005C)
{\
由两位十六进制数XX指定的Latin-1字符
\xXX
\uXXXX
由4位十六进制数XXX指定的Unicode宇符
幻果“\”" 字符位于役有在农3-1中列出的家符前，则忽略“\”(当然，JavaScript语言将
来的版本可能定义新的转义符)。比如，“\#”利“#”等价。最后，上文提到过，在
F.CMAScript 5中，允许在一个多行字符串直接量里的每行结束处使用反斜线。  

###  3.2.3 字符串的使用  

JavaScript的内置功能之一就是字符串连接。如果将加号(+)运算符用于数字，表示两数
相加。但将它作用于字符串,则表示字符串连接，将第二个字符串拼接在第一个之后,
例如:
```
nsg="Hello," + "world"; 11尘成字符申"He11o,wor1d"
greeting= "Welcome to my blog," +"" +
name;
```
要确定一个字符串的长度-
其所包含的16位位的个数---- .可以使用卞符串的1ength属
性。比如，要得到字符串s的长度:
```
s.length
```
除了1ength属性，字符串还提供许多叮以调用的方祛(可以在第三部分查判详细信息} :
11定义~个字符串
```
var s ="he1lo,world"
/ => "h": 第一个字符
s. ch arAt( 0}
/=>"d": 最后一个字符
s.charAt(s.length-1}
s.substring(1,4)
11=>"e11":第2~4个字符
11=>"ell": 同1:
s.slice{1,4)
"rld": 最斤三个字符
s.slice(-3)
s.index0f("1"}
/!=> 2; 字符1首欢出现的位置
uai
s.lastIndex0f("1")
1"> 10;半符1最后一次出现的位置
s.index0f("1"，3)
!!=> 3:在位世3及之后首次州现宇符1的位胃
5.split("，")
11=> ["hello","world"] 分割成子串
//=> "Hello,world": 全文字符替换
s. rep lace("h" ，"H" )
I/ => "HELL0,WORLD"
s.toUpperCase()
```
记住。在JavaScript中字符申是固定不变的，类似replace(}和toUpperCase()的方法都返
回新宇符申，原字符串本身并没有发生改变。
任ECMAScript 5中，字符串可以当儆只谈数组，除了使用charAt()方法，也可以使用方
括号来访问字符书巾的单个字符(16位值) ;
```
="hello,wor1d";
s[s.length-1]
!1=>"d"
```
甚于Mozila的Web浏览器(比如Firefox) 很久之前就支持这种方式的字符串索引，多数
现代浏览器(IE除外)也紧跟Mozill的脚步; 在ECMAScript 5成型之前就支持了这一特性。  

###  3.2.4 模式匹配  

JavaScript定义了RegExp()构造函数，用来创建表示文本匹配模式的对象。这些模式称为}
"正则表达式"
(regular expression); JavaSeript采用Perl中的正则表达式语法。String
利RegExp对象均定义了利用正则表达式进行模式匹配和查找与蒈换的函数。  

RegExp并不是JavaScript的基本类犁。和Date、样，它只尼一种具有实用API的特殊对
象。止则表达式的语法很复杂，API也很丰富。在第10章有详尽的文档介绍。RgeExp是
一种强大和常用的文本处理工具，本节只是个概述。  

尽管RegExp并不尼语言中的基本数据类型。但尽它们依然具有直接量写法，叮以直接在
JavaScript程序中使用。在两条斜线之间的文本构成了一个正则表达式直接量。第二条斜
线之后也可以跟随一个或多个宇母，用米修饰匹配模式的含义，例如;  
```
/“HTML/ //匹配以HTML开始豹字符申
/[1-9][o-g!*/ 11匹配一个非零数字，后面是任意个数尖
/bjavascript\b/i 11匹配单词"javascript"，忽略大小写
```
RegExp对象定义了很多有用的方祛，字符串同样具有可以接收RegFxp参数的方让，例如:  
```
war text= "testing: 1,2,3"; 11文本示例
var pattern= 八\d+/g 11匹配所有包含一个或多个数字的实例
pattern.test(text) /1曰> true: 匹配战功
以到位四
text.search{pattern) 11=> 9: 首次匹配成功的位蹬
text.match(pattern) /1=> ["1","2"，"3"]: 所有匹配组成的数组
text,replace(pattein,"#"); 11口> "testing: #,#; #"
text.split(/\D+/); l1=> [","1","2","3"]: 用非数宇字符截取宇符串
```

##  3.3 布尔值  

布尔值指代真或假，开或关、是或否。这个类型只有两个值，保留字true和false。
JavaScript程序中的比较语句的结果通常都是布尔值，例如:
```
a==4
```
这段代码用米检测变量a的位是否等十4。如果等十，比较结果的布尔值就恳true; 如朵
不等，比较结果则为false。
布尔值通常用于JavaScript中的控制结构中。例如，JavaScript中的if/e1se语句，如果布
尔值为true执行第一段逻辑，如果为fa1se执行另一段逻辑。通常将一个创建布尔值的比
较直接与使用这个比较的语句结合在一起.结果如下所示:
```
if (a== 4)
=b+1;
else
a=a+1
```
这段代码检测变量a是否等于4。如果等于，则b加] 1否则，a加1。我们同样会在3.8书讨
论到，任意JavaScript的值都可以转换为布尔值。下面这些值会被转换成fa1.se 
;
```
undefined
nul:
un 1! 空字符中
```
所有其他值，包括所有对象(数组) 都会转换成true。false和上面6个可以转换
成fa1.se 

的值有时称做“假值”(falsy value),其他值称做“真值”(truthy value)。
JavaScript期望使用一个布尔值的时候，假值会被当成false,真值会被当成true。
来看--个例子，假设变壁o是一个对象或是nu11，可以通过一条if语句来显式地检测a是
否是非nu11值:
```
if (o l== nu1l)...
```
不等操作符“!==”将o利nu11比较,并得出结果为true或false。可以先忽胳这里的比较
语句，nu11.一个假值，对象尼~个真值;
```
if (o)...
```
对于第一种情况，只有当o不是nu11时才会执行if后的代码，第二种情况的限制没那么严


格; 只有o不是false或任何假值(比如nu11或undefined) 时它才会执行这个if。到底选
用哪条语句取决于期望赋给o的值是什么。如果需要将nu11与0或""区分开来，则需要使
用一个显式的 比较。
布尔值包含toString()方法，因此可以使用这个方祛将字符串转换为“true" 或
“fa1se”，但它并不包含共他有用的方法。除了这个不重要的API,还有三个重要的布
尔运算符。
*&”运算符执行了逻辑与(AND) 操作。当且.仅当两个操作数都是真值时它才返川
trues 否则返回false。*I i" 运算符是布尔或(OR) 操作，如果两个操作数其中之一为
真值它就返回true,如果两个操作数都是假值则返l!lfalse.最后，一元操怍符“!”执
行了布尔非(NOT) 操作: 如果操作数是真值则返回false; 如果是假值,则返回trueo
比如:
if((x==0By==0) |1!(z==)) {
1! x 和y 都是零成z 是非零
关于操作数的完整的细节可以参照4.10节。  

##  3.4 null和undefined  

nu11是JavaScript语言的关键字，它表示一个特殊值，常用来描述“空值”。对nu11执
行typeof预算，结果返回字符串“bjec”，也就是说，可以将nu11认为是一个特殊的
对象值，含义是“非对象”。但实际上，通常认为nu11是它自有类型的唯一.个成贝，
它叮以表示数宁、字符串和对象是“无值”的。大多数编程语言和JavaScript:样含有
null: 你可能对null或ni1很眼熟。  

JavaScript还有第二个值来表示位的空觖。用未定义的值表示更深层次的“空值”。
它是变量的一种取值，裁明变量役有初始化，如果要查询对象属性或数组元素的值
时返回undef1ned则说明这个属性或元素不存在。如果函数没有返回你何值，则返回
undefined。引用役有提供实参的原数形参的位也只会得到undefined。undefined是
预定义的全局变量(它利nu11不一桦，它不尼关键字)，它的值就尼“术定义”。
f:ECMAScript 3中，undefined尼可读1写的变量，可以给它赋任意值。这个锴误在
ECMAScript 5中做了修正; undefined在该版本中是只读的。如果使用typeof运算符符到
undefined的类型，则返回“undefined",表明这个值是这个类型的唯一成员;  

尽管nullundefined足不同的,但它们都表示“值的空映”
两者往往可以互换。判断
相等运算符“==”认为肉者是相等的(要使用严格相等运算符“===" 来区分它们)
在希槊值是布尔类型的地方它们的值都是假值，和false类似。nu11和undefined都不包含

作何属性和方法。实际k.使用‘.”和“[]”米存取这两个值的成员或方法都会产生一
个类型错误。
你或许认为undefined悬表示系统级的、出乎意料的或类似错误的值的空缺，而nu11尼表
示程序级的、正常的或在意料之中的值的空缺。如果你想将它们赋位给变量或者属件，或
将它们作为参数传人函数，最佳选择是使用null.  

##  3.5 全局对象  

前几节!论丫JavaScript的原始类犁和原始值。对象类犁-
对象、数组和函数一一在
本书中均会有独立章节来讲述。但有-类非常重要的对象，我们不得不现在就把它们讲
清楚
-全局对象。全局对象(global object) 在JavaScript中布着重要的用途: 全局对
象的属怔是全局定义的符号，JavaScript嵇序叮以直接使用。当JavaScript解释器启动时
(或者任何[Web浏览器加戴渐页面的时候)，它将创建一个新的全局对象，并给它一组
定义的初始属性:  

- 全局属性，比如undefined.Infnity和NaN
- 全局函数，比如isNaN().parseInt() (见3.8 2节) 和eval() (见4.12节)
- 构造函数，比如Date().RegExp().String().0bject()和Array() (见3.8.2书)
- 全局对象，比如Math和ISON(见6 9节)  

全局对象的初始属性并不是保留字，但它们应该当做保留字来对待。2.4.1节列出了所
打这些属性。本竞对一部分全局属性也布描述。其他属性在其他竞节也会讲述。叮以
在第三部分中通过名称查找到，或者通过别名“Global”来找到这些全局对象。对于客
户端JavaScript来讲。Window对象定义了一些颓外的全局属性，可以在第凹部分中夺看
它们。  

在代码的最顶级一不在任何函数内的JavaScripI代码一可以使用JavaScript关键字
this来引用企局对象:
```
var global= this; 11定义一个引用全局对象的全局变量
```
在客八端JavaScript中,在其梭示的浏览器窗H中的所有JavaScript代码中，Window对象
充当「全局对象。这个全局Vindow对象有一个属性window引用其月身,它可以代替this
来引用全局对象。Window对象定义「核心全局属性，但它也针对Web浏览器和客户端
JavaScript定义了一少部分其他全局属性。  

当初次创建的时候，全局对象定义了JavaScript中所有的预定义全局值。这个特殊对象同

样包含了为程序定义的全局值。如果代码声明了一个杂局变录，这个全局变量胱是全局
对象的一个萬性，3.10.2书有关丁此的详尽解释。  

##  3.6 包装对象  

JavaSeript对象是一种复合值: 它是属性或已命名值的集合。通过“.”符号来引用属性
值。当属性值是一个函数的时候，称其为方法。通过o.m()来调用对象o中的方法。
我们看到字符串也同样具有属性和方汰;
```
/!一个字符串
var s 亚"hello wor1d !";
//使用字符串豹屎性
var word= 5.5ubstring(s.index0f(" ")+1,5.1ength);
```
字符串既然不是对象，为什么它会有属性呢? 只要引用了字符串s的属性，JavaScript就
会将字符串值通过调用new String(s)的方式转换成对象，这个对象继承了字符串的方
法(见6.2.2节)。并被用来处理属性的引用。一日属性引用结束，这个新创建的对象
就会销毁(其实在实现上并不一定创建或销毁这个临时对象，然而整个过程看起来是
这样)。  

同字符串一样，数字和布尔值也具有各自的方祛: 通过Number()利Boo1ean()构造函数创
建一个临时对象,这些方法的调用均是米自于这个临时对象。nul1和undefined没有包装
对象; 访问它们的属性会造成一个类型错误。
看如下代码，思考它们的执行结果;
```
11创她一个字符申
var s a"test";
!1给它设置--个属性
s.1en = 4;
var t = s.len;
1/ 秃询这个属性
```
当运行这段化码时。t的僨足undefined。第二行代码创建。个临时宁符串对象，并给其
1en属性赋值为4，随即销毁这个对象。第三行通过原始的(没有被修改过) 字符串位创
建一个新字符串对象，尝试族取其1en属性，这个属性自然不存在，表达式求值结果为
undefined。这段代码说明了在谈取字符串、数宇和布尔值的属性值(或方祛) 的时候,
表现的像对象-
一样。但如果你试图给其憾性赋值，则会忽脐这个操作: 修改只是发尘任
临时对象身上，而这个临时对象并未继续保留下米。  

存取字符串.数字或布尔值的属性时创建的临时对象称做包装对象。它只是偶尔用来区
分宇符串值利字符串对象、数宇和数值对象以及布尔值和布尔对象。通常，包装对象贝
是被看做是一种实现细节，而不用特别关往。由于宇符串、数字和布尔值的属性都是只
读的，并且不能给它们定义新属性，因此你锵要明白它们是有别于对象的。  

需要往意的恳，叮通过String().Number()或Boolean()构造函数来显式创建包装对象
```
11一个字符市、数字和布尔值
12I S="test",n = 1,b = true;
11一个字符串对象
var S= new string(s);
!1一个数值对象
var N = new Number(n) ;
叫
ar B= new Boolean(b);
!1一个布尔对象
```
对
JavaScript会在必要时将包装对象转换成原始值，因此上段化码中的对象S、N利B常
但不总是
常一
等于运算符将原始值和其包装对象
表现的和值s.n和b一样。
视为相等; 但“==”仝等运算符将它们视为不等。通过typeof运算符可以看刹原始值和
其包装对象的不同。  

##  3.7 不可变的原始值和可变的对象引用  

JavaScript中的点始值(undefined.nu11.布尔值、数字和宇符串) 与对象(包括数组和
涌数) 有肴根本区别。原始位是不可更改的; 任何方法都无法更改(或“突变”)一个
原始值。对数学和布尔位来说显然如此一改变数字的位本身就说不通，而对宇符串米
说就不那么明显了，丙为字符串看起米像由字符组成的数组，我们期望可以通过指定索
引来修改字符串中的字符。实际上，JavaScript是禁止这样微的。字符串州所有的方法看
k.去返回了-.个修改后的宁符串: 实际上.返回的是。个新的字符申值。例划:
```
! 定义--- 个由小写宇母组成的文本
var s ="hello";
/1返回"HELLO"，但并没有改变s的值
s.toUppexCase() ;
/=> "hello": 原始字符串的值井术改变
```
原始值的比较是值的比较: 只有住它们的值相等时它们才相等。这对数宇、布尔值、
nul1和undefined来说听起来有点儿难懂，并役有其他办法来比较它们。同样，对于字符
串来说则并不明显: 如果比较两个单独的字符书，当且仅当它们的长度相等且雏个索引[
的字符都相等时，JavaScript才认为它们相等。
它们的值是可修改的;
对象和原始值不同，首先，它们是可变的-
```
11定义一个对象
varoa{x:1};
11通过修改对象属性值来更改对象
D.X = 2;
1再次更改这个对象，给它池加一个新属性
0,y = 3;
var a= [1,2;3]
11数组也是可修改的
11更改数组的一个元索
a[o]= 0
11给数组增加个浙元素
a[3]= 4;
```
对象的比较并非位的比较: 即使两个对象包含同样的属怍及相同的位，它们也是不相等
的。条个索引元素完全相等的两个数组也不相等。
```
/1其有裉河属性的两个对象
var 口= {x:1}s p= {x:1};
/1=> false: 两个单独的对象永不相等
D === P
vara= []，b= [];
'I 两个单独的空数组
/1口> false; 两个节独的数组永不相等
```

